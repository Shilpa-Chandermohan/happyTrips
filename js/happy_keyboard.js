//Copyright (C) 2014 Panasonic Corporation. All Rights Reserved.
//
//*****************************************************************/
// File Name: happy_keyboard.js
// Purpose: This document creates the keyboard
// File Created Date: Aug 3rd 2014
// Release Date: Sep 23rd 2014
// Release Version: 0.6
//*****************************************************************/
/* jslint browser:true, plusplus: true */
/* global $, jQuery, main */
search={URL:"http://www.happytrips.com/searchfeed.cms?feedtype=sjson&reqtype=pagination&query=",prevObj:{},searchValue:"",currentPage:1,totalPages:0,encodedValue:"",prevCurrentPage:1,previousPage:1,display:"",prevValue:""};main.keyboardContainer=(function($,document,keyboardContainer){"use strict";keyboardContainer={};var keyboard={},sub,keyIndex,searchPlaceholder='Search';(function(){var head=document.getElementsByTagName('head')[0];var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href='css/happy_keyboard.css';head.appendChild(link);}());(function(){var keyboardOuter,mask,footer,footerText,footerImg,footerAnim;mask=document.createElement("div");document.getElementById('wrapper').appendChild(mask);mask.id='keyboardMask';keyboardOuter=document.createElement("div");document.getElementById('wrapper').appendChild(keyboardOuter);keyboardOuter.id='keyboardOuter';keyboardOuter.setAttribute('class','keyboardAnimDown');keyboardOuter.innerHTML='<div id="topContainer"><div id="topLogo1" class="topLogo"></div><div id="topBg" class="topBg"></div></div>'+'<div id="org"></div><div id="dup"></div><div id="keyboardContainer" class="show">'+'<div id="outer_search"><p>'+searchPlaceholder+'</p></div><div id="search_img"></div>'+'<input type="text" id="searchTextBox" maxlength="102"><ul id="keyboard">'+'<li id="row_1_1" class="specialChar focussedKey"><p class="false" style="padding-top:3px">`</p><p class="true">~</p></li>'+'<li id="row_1_2" class="specialChar"><p class="false">1</p><p class="true">!</p></li>'+'<li id="row_1_3" class="specialChar"><p class="false">2</p><p class="true">@</p></li>'+'<li id="row_1_4" class="specialChar"><p class="false">3</p><p class="true">#</p></li>'+'<li id="row_1_5" class="specialChar"><p class="false">4</p><p class="true">$</p></li>'+'<li id="row_1_6" class="specialChar"><p class="false">5</p><p class="true">%</p></li>'+'<li id="row_1_7" class="specialChar"><p class="false">6</p><p class="true">^</p></li>'+'<li id="row_1_8" class="specialChar"><p class="false">7</p><p class="true">&#38;</p></li>'+'<li id="row_1_9" class="specialChar"><p class="false">8</p><p class="true">*</p></li>'+'<li id="row_1_10" class="specialChar"><p class="false">9</p><p class="true">(</p></li>'+'<li id="row_1_11" class="specialChar"><p class="false">0</p><p class="true">)</p></li>'+'<li id="row_1_12" class="specialChar"><p class="false">-</p><p class="true">_</p></li>'+'<li id="row_1_13" class="specialChar"><p class="false">=</p><p class="true">+</p></li>'+'<li id="row_2_1" class="specialChar"><p class="false">;</p><p class="true">:</p></li>'+'<li id="row_2_2" class="specialChar"><p class="false">\'</p><p class="true">&quot;</p></li>'+'<li id="row_2_3" class="alphabet">q</li>'+'<li id="row_2_4" class="alphabet">w</li>'+'<li id="row_2_5" class="alphabet">e</li>'+'<li id="row_2_6" class="alphabet">r</li>'+'<li id="row_2_7" class="alphabet">t</li>'+'<li id="row_2_8" class="alphabet">y</li>'+'<li id="row_2_9" class="alphabet">u</li>'+'<li id="row_2_10" class="alphabet">i</li>'+'<li id="row_2_11" class="alphabet">o</li>'+'<li id="row_2_12" class="alphabet">p</li>'+'<li id="row_2_13" class="specialChar"><p class="false">\\</p><p class="true">|</p></li>'+'<li id="row_3_1" class="arrowLeft"><img id="shiftFocusLeft" src="images/search/arrow_key.png"/></li>'+'<li id="row_3_2" class="arrowRight"><img id="shiftFocusRight" src="images/search/arrow_key.png"/></li>'+'<li id="row_3_3" class="alphabet">a</li>'+'<li id="row_3_4" class="alphabet">s</li>'+'<li id="row_3_5" class="alphabet">d</li>'+'<li id="row_3_6" class="alphabet">f</li>'+'<li id="row_3_7" class="alphabet">g</li>'+'<li id="row_3_8" class="alphabet">h</li>'+'<li id="row_3_9" class="alphabet">j</li>'+'<li id="row_3_10" class="alphabet">k</li>'+'<li id="row_3_11" class="alphabet">l</li>'+'<li id="row_3_12" class="specialChar"><p class="false">[</p><p class="true">{</p></li>'+'<li id="row_3_13" class="specialChar"><p class="false">]</p><p class="true">}</p></li>'+'<li id="row_4_1" class="lShift">Shift</li>'+'<li id="row_4_2" class="alphabet">z</li>'+'<li id="row_4_3" class="alphabet">x</li>'+'<li id="row_4_4" class="alphabet">c</li>'+'<li id="row_4_5" class="alphabet">v</li>'+'<li id="row_4_6" class="alphabet">b</li>'+'<li id="row_4_7" class="alphabet">n</li>'+'<li id="row_4_8" class="alphabet">m</li>'+'<li id="row_4_9" class="specialChar"><p class="false">,</p><p class="true">&lt;</p></li>'+'<li id="row_4_10" class="specialChar"><p class="false">.</p><p class="true">&gt;</p></li>'+'<li id="row_4_11" class="specialChar"><p class="false">/</p><p class="true">?</p></li>'+'<li id="row_4_12" class="specialChar"><p class="false">@</p><p class="true">\'</p></li>'+'<li id="row_5_1" class="delete">'+'<div id="delText">Delete</div>'+'<div id="delImg"></div>'+'</li>'+'<li id="row_5_2" class="deleteAll">'+'<div id="delAllText">Delete All</div>'+'<div id="delAllImg"></div>'+'</li>'+'<li id="row_5_3" class="spaceBar">Space</li>'+'<li id="row_5_4" class="done">'+'<div id="doneText">Done</div>'+'<div id="doneImg"></div>'+'</li>'+'<li id="row_5_5" class="cancel">Cancel</li>'+'</ul>'+'</div>';footer=document.createElement("div");document.getElementById('keyboardOuter').appendChild(footer);footer.id="searchfooter";footer.setAttribute("class","keyboardAnimfooterDown");footer.innerHTML='<img id="footerImg" src="images/footer_bg_exit.png" />'+'<p id="footerText" ></p>'+'<div id="footerAnim"></div>';}());keyboard.reset=function(){keyIndex=1;sub=1;};keyboardContainer.animTop=function(){try{$("#footerAnim").removeClass('noFooterWidth');if(main.isSearchScreen){if(search.display!=search.searchValue){$('#searchTextBox').val(search.display);}else if(search.display==search.searchValue){$('#searchTextBox').val(search.display);}else{$('#searchTextBox').val("");}}
$('#keyboardOuter').css('display','block');main.isLoading=true;$("#keyboardMask").removeClass('keyboardMaskHide').addClass('keyboardMaskShow');$("#keyboardOuter").removeClass('keyboardAnimDown').addClass('keyboardAnimTop');if(main.keyboardContainer.isVisible){return;}
main.keyboardContainer.isVisible=true;$("#keyboardOuter").bind("animationend webkitAnimationEnd",function(event){if($("#keyboardOuter").hasClass('keyboardAnimTop')){keyboard.reset();$("#searchTextBox").focus();keyboard.enter_focus();}else{keyboard.leave_focus();$("#searchTextBox").blur();$("#keyboardMask").removeClass('keyboardMaskShow').addClass('keyboardMaskHide');}
main.isLoading=false;});}
catch(e)
{}};keyboardContainer.animDown=function(param){main.keyboardContainer.isVisible=false;$("#keyboardOuter").removeClass('keyboardAnimTop').addClass('keyboardAnimDown');error.errorObj.searchFree();main.isLoading=true;};keyboard.enter_focus=function(){main.focusedDom=keyboardContainer;$("#row_"+sub+"_"+keyIndex).addClass('focussedKey');if("row_"+sub+"_"+keyIndex==='row_3_1'){$("#shiftFocusLeft").attr("src","images/search/arrow_key.png");}else if("row_"+sub+"_"+keyIndex==='row_3_2'){$("#shiftFocusRight").attr("src","images/search/arrow_key.png");}};keyboard.leave_focus=function(){$("#row_"+sub+"_"+keyIndex).removeClass('focussedKey');if("row_"+sub+"_"+keyIndex==='row_3_1'){$("#shiftFocusLeft").attr("src","images/search/arrow_key.png");}else if("row_"+sub+"_"+keyIndex==='row_3_2'){$("#shiftFocusRight").attr("src","images/search/arrow_key.png");}};keyboard.checkWidthLeft=function(selection_Start){$("#dup").text($("#searchTextBox").val().substring(0,selection_Start).replace(/\s/g,"\u00a0"));var wid=parseFloat($("#org").outerWidth())-parseFloat($("#dup").outerWidth());if(wid>=860){$("#searchTextBox").scrollLeft(parseFloat($("#dup").outerWidth()));}};keyboard.checkWidthRight=function(selection_Start){$("#dup").text($("#searchTextBox").val().substring(0,selection_Start).replace(/\s/g,"\u00a0"));if(parseFloat($("#dup").outerWidth())>=860){$("#searchTextBox").scrollLeft(parseFloat($("#dup").outerWidth()));}};keyboardContainer.setData=function()
{var limit;var subLimit;if(main.jsonObj.CardList.length>=9){limit=3;}else if(search.currentPage==search.totalPages){limit=Math.ceil(main.jsonObj.CardList.length/3);}
else{limit=3;}
for(var tag=0;tag<limit;tag++)
{switch(tag)
{case 0:if(main.jsonObj.CardList.length==9){subLimit=3;}
else{if(main.jsonObj.CardList.length>=3){subLimit=3;}
else{subLimit=main.jsonObj.CardList.length%3;}}
break;case 1:if(main.jsonObj.CardList.length==9){subLimit=3;}
else{if(main.jsonObj.CardList.length>=6){subLimit=3;}
else{subLimit=main.jsonObj.CardList.length%3;}}
break;case 2:if(main.jsonObj.CardList.length==9){subLimit=3;}
else{if(main.jsonObj.CardList.length%3==0||main.jsonObj.CardList.length==10){subLimit=3;}
else{subLimit=main.jsonObj.CardList.length%3;}}
break;}
for(var loopVar=0;loopVar<subLimit;loopVar++)
{document.getElementById("gridsImg"+tag+loopVar).setAttribute("src",main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Thumb?main.jsonObj.CardList[(3*tag)+loopVar].Thumb+"&resize_mode=4&width=379&height=253":"images/listing/default_img.jpg");document.getElementById("gridsImg"+tag+loopVar).setAttribute("src",main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Thumb?main.jsonObj.CardList[(3*tag)+loopVar].Thumb+"&resize_mode=4&width=379&height=253":"images/listing/default_img.jpg");document.getElementById("gridsImg"+tag+loopVar).setAttribute("src",main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Thumb?main.jsonObj.CardList[(3*tag)+loopVar].Thumb+"&resize_mode=4&width=379&height=253":"images/listing/default_img.jpg");document.getElementById("gridsNamesMask"+tag+loopVar).innerHTML=(main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Title)?main.jsonObj.CardList[(3*tag)+loopVar].Title:(main.jsonObj.CardList[(3*tag)+loopVar].Caption?main.jsonObj.CardList[(3*tag)+loopVar].Caption:"");document.getElementById("gridsNamesMask"+tag+loopVar).innerHTML=(main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Title)?main.jsonObj.CardList[(3*tag)+loopVar].Title:(main.jsonObj.CardList[(3*tag)+loopVar].Caption?main.jsonObj.CardList[(3*tag)+loopVar].Caption:"");document.getElementById("gridsNamesMask"+tag+loopVar).innerHTML=(main.jsonObj.CardList[(3*tag)+loopVar]&&main.jsonObj.CardList[(3*tag)+loopVar].Title)?main.jsonObj.CardList[(3*tag)+loopVar].Title:(main.jsonObj.CardList[(3*tag)+loopVar].Caption?main.jsonObj.CardList[(3*tag)+loopVar].Caption:"");document.getElementById("grids"+tag+loopVar).setAttribute("focus",true);}}
if(listing.nextPageVar){listing.index=0;if(main.jsonObj.length!=0){if(listing.tag!==0){if(!$("#grids"+listing.tag+listing.index).attr("focus")){listing.tag-=1;if(!$("#grids"+listing.tag+listing.index).attr("focus")){listing.tag-=1;}}}}
listing.nextPageVar=false;}
document.getElementById("detailsImg").setAttribute("src",main.jsonObj.CardList[(3*listing.tag)+listing.index]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Thumb?main.jsonObj.CardList[(3*listing.tag)+listing.index].Thumb+"&resize_mode=4&width=560&height=378":"images/listing/default_img.png");document.getElementById("detailsText").innerHTML=(main.jsonObj&&main.jsonObj.CardList[(3*listing.tag)+listing.index]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags)?(((main.jsonObj&&main.jsonObj.CardList[(3*listing.tag)+listing.index]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[1]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[1].Text)?((main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0].Text)?main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0].Text+","+" "+main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[1].Text:""):(main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0].Text)?main.jsonObj.CardList[(3*listing.tag)+listing.index].Tags[0].Text:"")):"";($("#detailsText").html()==""?$("#detailsTextImg").css("visibility","hidden"):$("#detailsTextImg").css("visibility","visible"));if($("#gridsNamesMask"+listing.tag+listing.index).html()==""){document.getElementById("namesDiv").innerHTML="";}
else{document.getElementById("namesDiv").innerHTML=main.jsonObj.CardList[(3*listing.tag)+listing.index]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Title?main.jsonObj.CardList[(3*listing.tag)+listing.index].Title:(main.jsonObj.CardList[(3*listing.tag)+listing.index].Caption?main.jsonObj.CardList[(3*listing.tag)+listing.index].Caption:"");}
if(main.jsonObj.CardList[(3*listing.tag)+listing.index]&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Description&&main.jsonObj.CardList[(3*listing.tag)+listing.index].Description){$("#detailsImgLoadingText").removeClass('detailsImgLoadingTextChange').addClass('detailsImgLoadingText');$("#detailsImgDiv").removeClass('detailsImgDivChange').addClass('detailsImgDiv');$("#detailsImgShadow").removeClass('detailsImgShadowChange').addClass('detailsImgShadow');var listingDescription=main.jsonObj.CardList[(3*listing.tag)+listing.index].Description;listingDescription=home.homeObj.setOmitter(listingDescription,254.8,550,26,true);document.getElementById("detailsDescripInnerDiv").innerHTML=listingDescription;}else{$("#detailsImgLoadingText").removeClass('detailsImgLoadingText').addClass('detailsImgLoadingTextChange');$("#detailsImgDiv").removeClass('detailsImgDiv').addClass('detailsImgDivChange');$("#detailsImgShadow").removeClass('detailsImgShadow').addClass('detailsImgShadowChange');document.getElementById("detailsDescripInnerDiv").innerHTML="";}
for(var tag=0;tag<3;tag++){for(var loopVar=-1;loopVar<2;loopVar++){if(!listing.ListingGridContainerObj.check(tag,loopVar)){document.getElementById("gridsImg"+tag+(loopVar+1)).setAttribute("src","images/listing/coming_soon_img.png");$("#gridsNames"+tag+(loopVar+1)).remove();}}}
if(search.currentPage==1){listing.ListingGridContainerObj.disableLeftArrow();}
if(search.currentPage==2)
{listing.ListingGridContainerObj.enableLeftArrow();}
if(search.currentPage!=search.totalPages)
{listing.ListingGridContainerObj.enableRightArrow();}
else{listing.ListingGridContainerObj.disableRightArrow();}
if(search.totalPages==1)
{listing.ListingGridContainerObj.disableLeftArrow();listing.ListingGridContainerObj.disableRightArrow();}
document.getElementById("searchInputDiv").innerHTML=search.searchValue;document.getElementById("page").innerHTML=search.currentPage;document.getElementById("totalPages").innerHTML=search.totalPages;}
keyboard.createSearchMenu=function()
{var menu=document.getElementById("menuSection");var searchText=listing.createElement("div",{"id":"searchTextDiv","classname":"searchTextDiv","content":"Search Result of :"});menu.appendChild(searchText);var searchInput=listing.createElement("div",{"id":"searchInputDiv","classname":"searchInputDiv"});menu.appendChild(searchInput);var searchReturn=listing.createElement("div",{"id":"searchReturnDiv","classname":"searchReturnDiv","content":"Return To Menu"});menu.appendChild(searchReturn);var searchReturnImgDiv=listing.createElement("div",{"id":"searchReturnImgDiv","classname":"searchReturnImgDiv"});menu.appendChild(searchReturnImgDiv);}
keyboardContainer.getApi=function(value,page){error.errorObj.searchFree();if(!(search.currentPage==1)){main.loading.On();}
var currPage=page||1;var baseUrl=search.URL+value+"&curpg="+currPage;main.isLoading=true;main.xhr=$.ajax({type:"GET",url:baseUrl,timeout:30000,dataType:"jsonp",success:function(data){try{main.jsonObj=data;listing.currentPage=1;document.getElementById("footerText").innerHTML="";$("#footerAnim").removeClass('footerAnim').addClass('noFooterAnim noFooterWidth');if((main.jsonObj&&main.jsonObj.pagination&&main.jsonObj.pagination.total&&main.jsonObj.pagination.total==1&&main.jsonObj.pagination.current==1&&main.jsonObj.CardList&&main.jsonObj.CardList.length==1&&main.jsonObj.CardList[0].Msid==="00000")||main.jsonObj.CardList=="")
{$('#searchTextBox').val("");if(main.keyboardContainer.isVisible){error.errorObj.searchCreate(search.searchValue);}
main.jsonObj=search.prevObj;}
else if(main.jsonObj&&main.jsonObj.CardList&&main.jsonObj.CardList.length)
{$("#searchTextBox").blur();search.prevCurrentPage=search.currentPage;search.totalPages=main.jsonObj.pagination.total;search.prevValue=search.encodedValue;search.display=search.searchValue;search.prevObj=main.jsonObj;main.isSearchScreen=true;detail.galleryObj.freeOnReturn();keyboardContainer.animDown();home.menuObj.free();home.thumbnailObj.animation=false;home.carouselObj.free();$('#searchText').html(search.searchValue);main.searchGridsObj.free();$(".ListingDiv").remove();$(".ListingDivMaskChange").remove();listing.ListingContainerObj.create();keyboard.createSearchMenu();keyboardContainer.setData();main.focusedDom=listing.ListingGridContainerObj;main.focusedDom.enter_focus();}
else{keyboardContainer.animDown();main.focusedDom=home.searchObj;home.searchObj.enter_focus();}
main.pagination=false;}catch(ex){main.prevFocus=main.focusedDom;document.getElementById("footerText").innerHTML="";$("#footerAnim").removeClass('footerAnim').addClass('noFooterAnim noFooterWidth');$('#searchTextBox').val("");if(main.keyboardContainer.isVisible){if(ex.status===200){error.errorObj.searchCreate(search.searchValue);}else if(ex.status===0){error.errorObj.searchCreate("Internet connection is not available.");$('#errorSearchText').remove();}else{error.errorObj.searchCreate(search.searchValue);}}
else{if(ex.status===200){error.errorObj.screenCreate('No more results found.');}else if(ex.status===0){error.errorObj.screenCreate('Internet connection is not available.');}else{error.errorObj.screenCreate('No more results found.');}
error.errorObj.isDetailError=true;error.errorObj.isError=false;main.prevFocus=main.focusedDom;if(main.pagination){error.errorObj.isError=false;error.errorObj.isDetailError=true;main.pagination=false;search.currentPage=search.prevCurrentPage;if(main.prevPageVar){listing.index=0;main.prevPageVar=false;}}}
main.isLoading=false;}
main.loading.Off();},error:function(ex){main.prevFocus=main.focusedDom;document.getElementById("footerText").innerHTML="";$("#footerAnim").removeClass('footerAnim').addClass('noFooterAnim noFooterWidth');$('#searchTextBox').val("");if(main.keyboardContainer.isVisible){if(ex.status===200){error.errorObj.searchCreate(search.searchValue);}else if(ex.status===0){error.errorObj.searchCreate("Internet connection is not available.");$('#errorSearchText').remove();}else{error.errorObj.searchCreate(search.searchValue);}}else{if(!main.ajaxAbort){if(ex.status===200){error.errorObj.screenCreate('No more results found.');}else if(ex.status===0){error.errorObj.screenCreate('Internet connection is not available.');}else{error.errorObj.screenCreate('No more results found.');}
error.errorObj.isError=true;error.errorObj.isDetailError=true;main.prevFocus=main.focusedDom;if(main.pagination){error.errorObj.isError=false;error.errorObj.isDetailError=true;main.pagination=false;search.currentPage=search.prevCurrentPage;if(main.prevPageVar){listing.index=0;main.prevPageVar=false;}}}else{main.ajaxAbort=false;error.errorObj.screenCreate('Request has cancelled.');error.errorObj.isError=true;error.errorObj.isDetailError=true;main.prevFocus=main.focusedDom;if(main.pagination){error.errorObj.isError=false;error.errorObj.isDetailError=false;}}}
main.isLoading=false;}});};keyboard.search=function(){search.currentPage=1;listing.tag=0;listing.index=0;search.searchValue=jQuery.trim($('#searchTextBox').val());search.encodedValue=encodeURIComponent(search.searchValue);if($('#searchTextBox').val()===""||(jQuery.trim($('#searchTextBox').val())).length===0){error.errorObj.searchFree();$("#footerText").html("Please enter any search keyword.");$('#searchTextBox').val("");}else{document.getElementById("footerText").innerHTML="Loading...";$('#footerAnim').css('display','block');document.getElementById("footerAnim").setAttribute("class","footerAnim");keyboardContainer.getApi(search.encodedValue,search.currentPage);}};keyboard.check=function(){if($('#searchTextBox').val().length>=0){$("#outer_search p").text("");}
if($('#searchTextBox').val().length>=$('#searchTextBox').attr('maxlength')){$("#footerText").html("You have reached the limit of search keyword.");return;}};keyboardContainer.textboxErrorcheck=function(param){var parameter=param||"";if(parameter!==''){if(parameter[0]==="specialChar"||parameter[0]==="alphabet"||parameter[0]==="spaceBar"){keyboard.check();}}else{keyboard.check();}};keyboard.keyClick=function(id){var shift=false,capslock=false,$key=$("#"+id),className=$key.attr('class').split(" "),keyPressedVal,ctl,e1,prevSelectionStart;keyboardContainer.textboxErrorcheck(className);keyPressedVal=$key.html();switch(className[0]){case'arrowLeft':ctl=document.getElementById('searchTextBox');ctl.selectionStart-=1;ctl.selectionEnd-=1;keyboard.checkWidthLeft(ctl.selectionStart);return false;case'arrowRight':ctl=document.getElementById('searchTextBox');ctl.selectionStart+=1;keyboard.checkWidthRight(ctl.selectionStart);return false;case'lShift':$('.alphabet').toggleClass('uppercase');$('.specialChar p').toggle();$(".acc").toggleClass('up');shift=(shift===true)?false:true;capslock=false;return false;case'caps':$('.alphabet').toggleClass('uppercase');$(".acc").toggleClass('up');capslock=true;return false;case'deleteAll':keyboard.deleteAll();return false;case'delete':keyboard.Delete();return false;case'done':keyboard.search();return true;case'cancel':$("#searchTextBox").blur();main.isLoading=true;keyboardContainer.animDown();if(home.thumbnailObj.animation){home.thumbnailObj.startCount();}
if(!main.isSearchScreen){$('#searchTextBox').val("");}
main.focusedDom=home.searchObj;home.searchObj.enter_focus();error.errorObj.searchFree();search.encodedValue=search.prevValue;search.searchValue=search.display;search.currentPage=search.prevCurrentPage;main.jsonObj=search.prevObj;return true;case'specialChar':keyPressedVal=$('p:visible',$key).html();break;case'spaceBar':keyPressedVal=' ';break;case'tabSpace':keyPressedVal="\t";break;}
if($('#searchTextBox').val().length>$('#searchTextBox').attr('maxlength')){return true;}
if($key.hasClass('specialChar')){keyPressedVal=$('p:visible',$key).html();}
if($key.hasClass('spaceBar')){keyPressedVal=' ';}
if($key.hasClass('deleteAll')){keyPressedVal="\n";}
if($key.hasClass('uppercase')){keyPressedVal=keyPressedVal.toUpperCase();}
if(shift===true){$('.specialChar p').toggle();if(capslock===false){$('.alphabet').toggleClass('uppercase');}
shift=false;}
if(keyPressedVal==='&amp;'){document.getElementById('searchTextBox').value+='&';return;}
if(keyPressedVal==='&lt;'){document.getElementById('searchTextBox').value+='<';return;}
if(keyPressedVal==='&gt;'){document.getElementById('searchTextBox').value+='>';return;}
try{e1=document.getElementById('searchTextBox');prevSelectionStart=e1.selectionStart+1;e1.value=e1.value.slice(0,e1.selectionStart)+keyPressedVal+e1.value.slice(e1.selectionEnd);e1.selectionStart=prevSelectionStart;e1.selectionEnd=prevSelectionStart;keyboard.checkWidthRight(e1.selectionStart);$("#org").text(e1.value);}catch(ignore){}};keyboard.arrowRight=function(){keyIndex=keyIndex+1;if($("#row_"+sub+"_"+keyIndex).length){keyboard.enter_focus();keyIndex=keyIndex-1;keyboard.leave_focus();keyIndex=keyIndex+1;}else{keyIndex=keyIndex-1;keyboard.leave_focus();keyIndex=1;keyboard.enter_focus();}};keyboard.ArrowLeft=function(){keyIndex=keyIndex-1;if($("#row_"+sub+"_"+keyIndex).length){keyboard.enter_focus();keyIndex=keyIndex+1;keyboard.leave_focus();keyIndex=keyIndex-1;}else{keyIndex=keyIndex+1;keyboard.leave_focus();switch(sub){case'1':keyIndex=13;break;case'2':keyIndex=13;break;case'3':keyIndex=13;break;case'4':keyIndex=12;break;case'5':keyIndex=5;break;}
keyboard.enter_focus();}};keyboard.ArrowUp=function(){keyboard.leave_focus();switch(sub){case'5':if(keyIndex===3){keyIndex=4;}else if(keyIndex===4){keyIndex=9;}else if(keyIndex===5){keyIndex=11;}
break;case'4':if(keyIndex>=2){keyIndex=keyIndex+1;}
break;case'1':sub=6;if(keyIndex<=2){keyIndex=1;}else if(keyIndex<=4){keyIndex=2;}else if(keyIndex<=9){keyIndex=3;}else if(keyIndex<=11){keyIndex=4;}else{keyIndex=5;}
break;default:sub=sub-1;if($("#row_"+sub+"_"+keyIndex).length){keyboard.enter_focus();}else{keyIndex=keyIndex-1;keyboard.enter_focus();}
return true;}
sub=sub-1;keyboard.enter_focus();};keyboard.ArrowDown=function(){keyboard.leave_focus();switch(sub){case'3':if(keyIndex===1||keyIndex===2){keyIndex=1;}
if(keyIndex>=3&&keyIndex<=13){keyIndex=keyIndex-1;}
break;case'4':if(keyIndex===2||keyIndex===3){keyIndex=2;}else if(keyIndex>=4&&keyIndex<=8){keyIndex=3;}else if(keyIndex===9||keyIndex===10){keyIndex=4;}else if(keyIndex>=11){keyIndex=5;}
break;case'5':sub=0;if(keyIndex===2){keyIndex=3;}else if(keyIndex===3){keyIndex=5;}else if(keyIndex===4){keyIndex=10;}else if(keyIndex===5){keyIndex=12;}
break;default:sub++;if($("#row_"+sub+"_"+keyIndex).length){keyboard.enter_focus();}else{keyIndex=keyIndex-1;keyboard.enter_focus();}
return true;}
sub++;keyboard.enter_focus();};keyboard.Delete=function(){if($('#searchTextBox').val()===""){return false;}
var html=$('#searchTextBox').val();var e1=document.getElementById('searchTextBox');var prevSelectionStart=e1.selectionStart-1;try{$("#searchTextBox").val(html.substring(0,e1.selectionStart-1)+html.substring(e1.selectionStart));}catch(e){}
e1.selectionStart=prevSelectionStart;e1.selectionEnd=prevSelectionStart;this.checkWidthRight(prevSelectionStart);$("#dup").text(e1.value);$("#org").text(e1.value);if($('#searchTextBox').val()===""){$("#outer_search p").text(searchPlaceholder);}
return true;};keyboard.deleteAll=function(){$("#searchTextBox").val("");$("#outer_search p").text(searchPlaceholder);$("#org").text($('#searchTextBox').val());$("#dup").text($('#searchTextBox').val());};keyboardContainer.KeyboardEvent=function(e,eventType){sub=$(".focussedKey").attr("id");sub=sub.split("_");sub=sub[1];$("#footerText").html('');error.errorObj.searchFree();var key=e,id="row_"+sub+"_"+keyIndex;event.preventDefault();switch(eventType){case"keydown":switch(key){case"arrowright":keyboard.arrowRight();break;case"arrowleft":keyboard.ArrowLeft();break;case"arrowup":keyboard.ArrowUp();break;case"arrowdown":keyboard.ArrowDown();break;case"ok":id="row_"+sub+"_"+keyIndex;keyboard.keyClick(id);break;case"return":$("#searchTextBox").blur();event.preventDefault();main.isLoading=true;keyboardContainer.animDown();if(home.thumbnailObj.animation){home.thumbnailObj.startCount();}
if(!main.isSearchScreen){$('#searchTextBox').val("");}
main.focusedDom=home.searchObj;home.searchObj.enter_focus();error.errorObj.searchFree();search.encodedValue=search.prevValue;search.searchValue=search.display;search.currentPage=search.prevCurrentPage;main.jsonObj=search.prevObj;break;case"blue":keyboard.search();break;case"green":keyboard.deleteAll();break;case"red":keyboard.Delete()
break;default:keyboardContainer.textboxErrorcheck();break;}
break;}
return true;};return keyboardContainer;}($,document,main.keyboardContainer));